# /etc/fail2ban/filter.d/lampac-admin.conf
#
# Fail2ban filter for Alpac admin login failures.
# Matches zerolog JSON output with "auth":"failed" or "auth":"blocked".
#
# Log examples:
#   {"level":"warn","ip":"1.2.3.4","auth":"failed","time":"...","message":"admin login: invalid password"}
#   {"level":"warn","ip":"1.2.3.4","auth":"failed","time":"...","message":"admin login: invalid TOTP code"}
#   {"level":"warn","ip":"1.2.3.4","auth":"blocked","time":"...","message":"admin login: rate limit exceeded"}

[Definition]
failregex = "ip":"<HOST>".*"auth":"(?:failed|blocked)".*"message":"admin login:
ignoreregex =
