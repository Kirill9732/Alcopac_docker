# /etc/fail2ban/jail.d/lampac-admin.conf
#
# Fail2ban jail for Alpac admin panel brute-force protection.
# Bans IP after 5 failed login attempts within 15 minutes for 1 hour.
#
# For systemd:
#   backend = systemd
#   journalmatch = _SYSTEMD_UNIT=lampac.service
#
# For Docker (log file):
#   backend = auto
#   logpath = /path/to/lampac-go.log

[lampac-admin]
enabled  = true
filter   = lampac-admin
# --- Choose ONE backend ---
# Option A: systemd (bare-metal install)
backend  = systemd
journalmatch = _SYSTEMD_UNIT=lampac.service
# Option B: Docker log file (uncomment and set path)
# backend = auto
# logpath = /var/log/lampac-go.log

maxretry = 5
findtime = 900
bantime  = 3600
action   = iptables-multiport[name=lampac-admin, port="http,https"]
